@{
    Layout = null;
    int PageCurrent = 0;

}
<div class='col-md-12 col-xs-12 margin-top-10'>
    <label class='control-label'><b>TỔNG SỐ HÓA ĐƠN TRONG NGÀY: @ViewBag.TotalRecord</b></label>
</div>

<div class='col-md-12 col-xs-12 margin-top-10'>
    <b>
        <span>TỔNG SỐ HÓA ĐƠN THEO BỘ LỌC:</span> <span style="color:red">@ViewBag.TotalFilter</span>
        <span>TỔNG TIỀN CHƯA VAT:</span> <span style="color:red">@ViewBag.TotalNoVat</span>
        <span>TỔNG TIỀN VAT:</span> <span style="color:red">@ViewBag.TotalVat</span>
        <span>TỔNG TIỀN:</span> <span style="color:red">@ViewBag.Total</span>
    </b>
</div>
<div class="col-md-pull-12">
    <table class="table table-striped table-bordered table-advance table-hover dt-responsive" id="tbl-invoice">
        <thead>
            <tr>
                <th class="all" style="width:3%;font-size:16px;background-color:yellow !important;text-align:center"></th>
                <th style="width:10%"></th>
                <th style="width:10%;font-size:14px;background-color:yellow !important;text-align:center">
                    Số HD
                </th>
                <th style="width:10%;font-size:14px;background-color:yellow !important;text-align:center">
                    AWB
                </th>
                <th style="width:10%;font-size:14px;background-color:yellow !important;text-align:center">
                    HAWB
                </th>
                <th style="width:10%;font-size:14px;background-color:yellow !important;text-align:center">
                    TỔNG TIỀN CHƯA VAT
                </th>
                <th style="width:10%;font-size:14px;background-color:yellow !important;text-align:center">
                    THUẾ VAT
                </th>

                <th style="width:10%;font-size:14px;background-color:yellow !important;text-align:center">
                    TỔNG TIỀN
                </th>

                <th style="width:10%;font-size:14px;background-color:yellow !important">
                    TRẠNG THÁI
                </th>
                <th style="width:10%;font-size:14px;background-color:yellow !important">
                    Số HDDT
                </th>


                <th style="width:10%;font-size:16px;background-color:yellow !important;text-align:center">
                    Khách hàng:
                </th>
                <th style="width:10%;font-size:16px;background-color:yellow !important;text-align:center">
                    Địa chỉ:
                </th>
                <th style="width:10%">
                    MST
                </th>

                <th style="width:10%">
                    NHÂN VIÊN TẠO HĐ
                </th>
                <th style="width:10%">
                    Thanh toán
                </th>
                <th style="width:10%;font-size:16px;background-color:yellow !important;text-align:center">
                    Số Tham chiếu
                </th>
                <th style="width:10%;font-size:16px;background-color:yellow !important;text-align:center">
                    Executed Time
                </th>
                <th style="width:10%;font-size:16px;background-color:yellow !important;text-align:center">
                    Note
                </th>
                <th style="width:10%;font-size:16px;background-color:yellow !important;text-align:center">
                    Created
                </th>
               
            </tr>
        </thead>
        <tbody>
            @foreach (var row in (IList<Web.Portal.Model.Models.HermesInvoice>)ViewData["InvoiceLists"])
            {
                PageCurrent += 1;

                <tr style="@Html.Raw(row.InvoiceStatus==3? "background-color:#FFA07A !important" : "")">
                    <td>@PageCurrent</td>
                    <td>
                        <div class="btn-group">
                            <button class="btn green btn-sm btn-outline  dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                <i class="fa fa-angle-down"></i>
                            </button>
                            <ul class="dropdown-menu pull-right" style="padding-right:55px">
                                <li>
                                    <a href="javascript:;" title="Xem chi tiết" class="invoice_detail btn btn-xs" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-search">Xem chi tiết</i>
                                    </a>
                                </li>
                                <li>
                                    <a title="Hóa đơn giấy" class="btn-doc btn btn-xs" data-doc="@Html.DisplayFor(model => row.InvoiceLink)" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-paperclip">Hóa đơn giấy</i>
                                    </a>
                                </li>
                                <li>
                                    <a title="XUẤT LẠI HÓA ĐƠN" class="einvoice_replace btn btn-xs @Html.Raw(row.InvoiceStatus==3? "" : "disabled")" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-cloud-download">Xuất lại HĐ</i>
                                    </a>
                                </li>
                                <li>
                                    <a title="PHÊ DUYỆT HÓA ĐƠN" class="einvoice_appr btn btn-xs @Html.Raw(row.InvoiceStatus==4? "" : "disabled")" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-check">Phê duyệt HĐ</i>
                                    </a>
                                </li>
                                <li>
                                    <a title="Edit" class="einvoice_edit btn btn-xs @Html.Raw((row.InvoiceStatus!=0) ? "disabled" : "")" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-edit">SỬA</i>
                                    </a>
                                </li>
                                @*<li>
                                    <a title="Cancel" class="einvoice_cancel btn btn-xs" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-trash">HỦY</i>
                                    </a>
                                </li>*@
                                <li>
                                    <a title="Edit" class="einvoice_print btn btn-xs  @Html.Raw(row.InvoiceStatus==1 ? "disabled" : "")" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-print">IN LẠI</i>
                                    </a>
                                </li>
                                <li>
                                    <a title="Edit" class="einvoice_checkError btn btn-xs @Html.Raw(row.InvoiceStatus!=0 ? "disabled" : "")" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-info-circle">KIỂM TRA LỖI</i>
                                    </a>
                                </li>
                                <li>
                                    <a title="Edit" href="@Html.Raw(row.EInvoiceSearchLink)" target="_blank" class="btn btn-xs  @Html.Raw(row.InvoiceStatus==1 ? "disabled" : "")" data-id="@Html.DisplayFor(model => row.InvoiceIsn)">
                                        <i class="fa fa-link">Link HDDT</i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.InvoiceNumber)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.AWB)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.Hawb)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.Raw(row.InvoiceTotalNoVatAmount.ToString("N2"))</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.Raw(row.InvoiceTotalVatAmount.ToString("N2"))</a></td>

                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.Raw(row.InvoiceTotalAmount.ToString("N2"))</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.Raw(row.InvoiceDescription)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.Raw(row.Sequence.HasValue ? row.Sequence.ToString().PadLeft(7, '0') : "")</a></td>


                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.KundName)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.Address)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.TaxCode)</a></td>

                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.PersonName)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.Raw(row.Payment.Trim().Equals("BANK TFR") ? "Chuyển khoản" : "Tiền mặt")</a></td>
                    <td>@Html.DisplayTextFor(model => row.InvoiceIsn)</td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.ExecuteTime)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.Raw(string.IsNullOrEmpty(row.Note)? "" : row.Note)</a></td>
                    <td><a href="#" class="btn edit-hawb  btn-xs">@Html.DisplayTextFor(model => row.Created)</a></td>
                </tr>
            }
        </tbody>

    </table>
    @*<div class="box-footer clearfix">
            @Html.Raw(ViewBag.Paging)

        </div>*@
</div>

<script>
        //egovutil.loadPaging(pagingeinv, "/einvoice/list?ps=" + $("#pagingeinv_step").val() + "&awb=" + $("#iv_mawb").val()
        //                                                                + "&ty=" + $("#iv_type").val()
        //                                                                + "&date=" + $("#tda").val(), "#content-list-result");
        //$("#pagingeinv_step").change(function () {
        //    egovutil.getContent("#content-listUld-result", "/einvoice/list?ps=" + $("#pagingeinv_step").val() + "&awb=" + $("#iv_mawb").val()
        //                                                                + "&ty=" + $("#iv_type").val()
        //                                                                + "&date=" + $("#tda").val());
        //});
        egovutil.CreateTableSort("#tbl-invoice", [[0, "asc"]], [

        {

            "orderable": false, "targets": [0, 0]
        }
        ], false);
        $(".invoice_detail").click(function () {
            egovutil.dialog("Chi tiết hóa đơn", "large", "/einvoice/invoicedetail?invoiceIsn=" + $(this).data('id'), "invoiceAction.search()");
        });
        $(".einvoice_edit").click(function () {
            egovutil.dialog("SỬA THÔNG TIN HÓA ĐƠN", "large", "/einvoice/edit?invoiceIsn=" + $(this).data('id'), "invoiceAction.search()");
        });
        $(".einvoice_replace").click(function () {
            egovutil.dialog("XUẤT LẠI HÓA ĐƠN", "large", "/einvoice/Replace?invoiceIsn=" + $(this).data('id'), "invoiceAction.search()");
        });
        $(".einvoice_appr").click(function () {
            egovutil.dlgConfirmAction("PHÊ DUYỆT HÓA ĐƠN", "BẠN CÓ MUỐN PHÊ DUYỆT HÓA ĐƠN NÀY? ", "/einvoice/ApprInvoice?invoiceIsn=" + $(this).data('id'), "invoiceAction.search()");
        });
        $(".btn-doc").click(function () {
            window.open("/einvoice/OpenDoc?link=" + $(this).data('doc') + "&invoiceins=" + $(this).data('id'));
        });
        $(".einvoice_print").click(function () {
            window.open("/einvoice/Reprint?invoiceins=" + $(this).data('id'));
            // window.location.href = "/einvoice/OpenDoc?link=" + $(this).data('doc')
        });
        $(".einvoice_detail").click(function () {
            window.open("/einvoice/RePrint?invoiceIsn=" + $(this).data('id'), "")
        });
        $(".einvoice_checkError").click(function () {
            egovutil.dialog("CHI TIẾT LỖI","large","/einvoice/CheckError?invoiceIsn=" + $(this).data('id'), "")
        });
        $(".einvoice_cancel").click(function () {
            egovutil.dlgConfirmAction("HỦY HÓA ĐƠN", "BẠN CÓ MUỐN HỦY HÓA ĐƠN NÀY? ", "/einvoice/CancelInvoice?invoiceIsn=" + $(this).data('id'), "invoiceAction.search()");
        });
</script>
